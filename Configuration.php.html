<html>
<head>
<title>Configuration.php</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #a9b7c6;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #629755; font-weight: bold; font-style: italic;}
.s6 { color: #77b767; font-style: italic;}
.s7 { color: #9876aa;}
.s8 { color: #6a8759;}
.s9 { color: #6897bb;}
.ls0 { height: 1px; border-width: 0; color: #4d4d4d; background-color:#4d4d4d}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Configuration.php</font>
</center></td></tr></table>
<pre><span class="s0">&lt;?php</span>

<span class="s2">/* 
 * This file is part of the Symfony package. 
 * 
 * (c) Fabien Potencier &lt;fabien@symfony.com&gt; 
 * 
 * For the full copyright and license information, please view the LICENSE 
 * file that was distributed with this source code. 
 */</span>
<hr class="ls0"><span class="s0">namespace </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Bundle</span><span class="s1">\</span><span class="s3">FrameworkBundle</span><span class="s1">\</span><span class="s3">DependencyInjection</span><span class="s0">;</span>

<span class="s0">use </span><span class="s3">Doctrine</span><span class="s1">\</span><span class="s3">Common</span><span class="s1">\</span><span class="s3">Annotations</span><span class="s1">\</span><span class="s3">Annotation</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Doctrine</span><span class="s1">\</span><span class="s3">Common</span><span class="s1">\</span><span class="s3">Cache</span><span class="s1">\</span><span class="s3">Cache</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Doctrine</span><span class="s1">\</span><span class="s3">DBAL</span><span class="s1">\</span><span class="s3">Connection</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Bundle</span><span class="s1">\</span><span class="s3">FullStack</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Asset</span><span class="s1">\</span><span class="s3">Package</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Config</span><span class="s1">\</span><span class="s3">Definition</span><span class="s1">\</span><span class="s3">Builder</span><span class="s1">\</span><span class="s3">ArrayNodeDefinition</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Config</span><span class="s1">\</span><span class="s3">Definition</span><span class="s1">\</span><span class="s3">Builder</span><span class="s1">\</span><span class="s3">TreeBuilder</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Config</span><span class="s1">\</span><span class="s3">Definition</span><span class="s1">\</span><span class="s3">ConfigurationInterface</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Config</span><span class="s1">\</span><span class="s3">Definition</span><span class="s1">\</span><span class="s3">Exception</span><span class="s1">\</span><span class="s3">InvalidConfigurationException</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">DependencyInjection</span><span class="s1">\</span><span class="s3">Exception</span><span class="s1">\</span><span class="s3">LogicException</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Form</span><span class="s1">\</span><span class="s3">Form</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">HttpClient</span><span class="s1">\</span><span class="s3">HttpClient</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">HttpFoundation</span><span class="s1">\</span><span class="s3">Cookie</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Lock</span><span class="s1">\</span><span class="s3">Lock</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Lock</span><span class="s1">\</span><span class="s3">Store</span><span class="s1">\</span><span class="s3">SemaphoreStore</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Mailer</span><span class="s1">\</span><span class="s3">Mailer</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Messenger</span><span class="s1">\</span><span class="s3">MessageBusInterface</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Notifier</span><span class="s1">\</span><span class="s3">Notifier</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">PropertyInfo</span><span class="s1">\</span><span class="s3">PropertyInfoExtractorInterface</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Serializer</span><span class="s1">\</span><span class="s3">Serializer</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Translation</span><span class="s1">\</span><span class="s3">Translator</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">Validator</span><span class="s1">\</span><span class="s3">Validation</span><span class="s0">;</span>
<span class="s0">use </span><span class="s3">Symfony</span><span class="s1">\</span><span class="s3">Component</span><span class="s1">\</span><span class="s3">WebLink</span><span class="s1">\</span><span class="s3">HttpHeaderSerializer</span><span class="s0">;</span>
<hr class="ls0"><span class="s4">/**</span>
 <span class="s4">* FrameworkExtension configuration structure.</span>
 <span class="s4">*</span>
 <span class="s4">* </span><span class="s5">@author </span><span class="s4">Jeremy Mikola </span><span class="s6">&lt;jmikola</span><span class="s4">@gmail.com&gt;</span>
 <span class="s4">* </span><span class="s5">@author </span><span class="s4">Gr√©goire Pineau </span><span class="s6">&lt;lyrixx</span><span class="s4">@lyrixx.info&gt;</span>
 <span class="s4">*/</span>
<span class="s0">class </span><span class="s3">Configuration </span><span class="s0">implements </span><span class="s3">ConfigurationInterface</span>
<span class="s1">{</span>
    <span class="s0">private </span><span class="s7">$debug</span><span class="s0">;</span>

    <span class="s4">/**</span>
     <span class="s4">* </span><span class="s5">@param </span><span class="s4">bool $debug Whether debugging is enabled or not</span>
     <span class="s4">*/</span>
    <span class="s0">public function </span><span class="s3">__construct</span><span class="s1">(</span><span class="s3">bool </span><span class="s7">$debug</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug </span><span class="s1">= </span><span class="s7">$debug</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s4">/**</span>
     <span class="s4">* Generates the configuration tree builder.</span>
     <span class="s4">*</span>
     <span class="s4">* </span><span class="s5">@return </span><span class="s4">TreeBuilder The tree builder</span>
     <span class="s4">*/</span>
    <span class="s0">public function </span><span class="s3">getConfigTreeBuilder</span><span class="s1">()</span>
    <span class="s1">{</span>
        <span class="s7">$treeBuilder </span><span class="s1">= </span><span class="s0">new </span><span class="s3">TreeBuilder</span><span class="s1">(</span><span class="s8">'framework'</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$rootNode </span><span class="s1">= </span><span class="s7">$treeBuilder</span><span class="s1">-&gt;</span><span class="s3">getRootNode</span><span class="s1">()</span><span class="s0">;</span>

        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">!</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'assets'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'templating'</span><span class="s1">]) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Package</span><span class="s1">::</span><span class="s0">class</span><span class="s1">)</span><span class="s0">; </span><span class="s1">})</span>
                <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                    <span class="s7">$v</span><span class="s1">[</span><span class="s8">'assets'</span><span class="s1">] = []</span><span class="s0">;</span>

                    <span class="s0">return </span><span class="s7">$v</span><span class="s0">;</span>
                <span class="s1">})</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'secret'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'http_method_override'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">&quot;Set true to enable support for the '_method' request parameter to determine the intended HTTP method on POST requests. Note: When using the HttpCache, you need to call the method in your front controller instead&quot;</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'ide'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'test'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_locale'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'en'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'trusted_hosts'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">ifString</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'error_controller'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'error_controller'</span><span class="s1">)</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>

        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addCsrfSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addFormSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addEsiSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addSsiSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addFragmentsSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addProfilerSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addWorkflowSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addRouterSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addSessionSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addRequestSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addAssetsSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addTranslatorSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addValidationSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addAnnotationsSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addSerializerSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addPropertyAccessSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addPropertyInfoSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addCacheSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addPhpErrorsSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addWebLinkSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addLockSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addMessengerSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addRobotsIndexSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addHttpClientSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addMailerSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addSecretsSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">addNotifierSection</span><span class="s1">(</span><span class="s7">$rootNode</span><span class="s1">)</span><span class="s0">;</span>

        <span class="s0">return </span><span class="s7">$treeBuilder</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addSecretsSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'secrets'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeDisabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'vault_directory'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.project_dir%/config/secrets/%kernel.environment%'</span><span class="s1">)-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'local_dotenv_file'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.project_dir%/.env.%kernel.environment%.local'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'decryption_env_var'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'base64:default::SYMFONY_DECRYPTION_SECRET'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addCsrfSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'csrf_protection'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">treatFalseLike</span><span class="s1">([</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">false</span><span class="s1">])</span>
                    <span class="s1">-&gt;</span><span class="s3">treatTrueLike</span><span class="s1">([</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s1">])</span>
                    <span class="s1">-&gt;</span><span class="s3">treatNullLike</span><span class="s1">([</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s1">])</span>
                    <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s2">// defaults to framework.session.enabled &amp;&amp; !class_exists(FullStack::class) &amp;&amp; interface_exists(CsrfTokenManagerInterface::class)</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'enabled'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addFormSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'form'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'form configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Form</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'csrf_protection'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">treatFalseLike</span><span class="s1">([</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">false</span><span class="s1">])</span>
                            <span class="s1">-&gt;</span><span class="s3">treatTrueLike</span><span class="s1">([</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s1">])</span>
                            <span class="s1">-&gt;</span><span class="s3">treatNullLike</span><span class="s1">([</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s1">])</span>
                            <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'enabled'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">() </span><span class="s2">// defaults to framework.csrf_protection.enabled</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'field_name'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'_token'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addEsiSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'esi'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'esi configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addSsiSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'ssi'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'ssi configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addFragmentsSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'fragments'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'fragments configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'hinclude_default_template'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'path'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'/_fragment'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addProfilerSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'profiler'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'profiler configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'collect'</span><span class="s1">)-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'only_exceptions'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'only_master_requests'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'dsn'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'file:%kernel.cache_dir%/profiler'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addWorkflowSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'workflow'</span><span class="s1">)</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'workflows'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                            <span class="s0">if </span><span class="s1">(\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; </span><span class="s3">true </span><span class="s1">=== </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">]) {</span>
                                <span class="s7">$workflows </span><span class="s1">= </span><span class="s7">$v</span><span class="s0">;</span>
                                <span class="s0">unset</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">])</span><span class="s0">;</span>

                                <span class="s0">if </span><span class="s1">(</span><span class="s9">1 </span><span class="s1">=== \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s9">0</span><span class="s1">][</span><span class="s8">'enabled'</span><span class="s1">]) &amp;&amp; </span><span class="s9">1 </span><span class="s1">=== \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s9">0</span><span class="s1">])) {</span>
                                    <span class="s7">$workflows </span><span class="s1">= []</span><span class="s0">;</span>
                                <span class="s1">}</span>

                                <span class="s0">if </span><span class="s1">(</span><span class="s9">1 </span><span class="s1">=== \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s8">'workflows'</span><span class="s1">]) &amp;&amp; </span><span class="s3">array_keys</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s8">'workflows'</span><span class="s1">]) !== </span><span class="s3">range</span><span class="s1">(</span><span class="s9">0</span><span class="s0">, </span><span class="s1">\</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">) - </span><span class="s9">1</span><span class="s1">) &amp;&amp; !</span><span class="s0">empty</span><span class="s1">(</span><span class="s3">array_diff</span><span class="s1">(</span><span class="s3">array_keys</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s8">'workflows'</span><span class="s1">])</span><span class="s0">, </span><span class="s1">[</span><span class="s8">'audit_trail'</span><span class="s0">, </span><span class="s8">'type'</span><span class="s0">, </span><span class="s8">'marking_store'</span><span class="s0">, </span><span class="s8">'supports'</span><span class="s0">, </span><span class="s8">'support_strategy'</span><span class="s0">, </span><span class="s8">'initial_marking'</span><span class="s0">, </span><span class="s8">'places'</span><span class="s0">, </span><span class="s8">'transitions'</span><span class="s1">]))) {</span>
                                    <span class="s7">$workflows </span><span class="s1">= </span><span class="s7">$workflows</span><span class="s1">[</span><span class="s8">'workflows'</span><span class="s1">]</span><span class="s0">;</span>
                                <span class="s1">}</span>

                                <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$workflows </span><span class="s0">as </span><span class="s7">$key </span><span class="s1">=&gt; </span><span class="s7">$workflow</span><span class="s1">) {</span>
                                    <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$workflow</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">]) &amp;&amp; </span><span class="s3">false </span><span class="s1">=== </span><span class="s7">$workflow</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">]) {</span>
                                        <span class="s0">throw new </span><span class="s3">LogicException</span><span class="s1">(</span><span class="s3">sprintf</span><span class="s1">(</span><span class="s8">'Cannot disable a single workflow. Remove the configuration for the workflow &quot;%s&quot; instead.'</span><span class="s0">, </span><span class="s7">$workflow</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">]))</span><span class="s0">;</span>
                                    <span class="s1">}</span>

                                    <span class="s0">unset</span><span class="s1">(</span><span class="s7">$workflows</span><span class="s1">[</span><span class="s7">$key</span><span class="s1">][</span><span class="s8">'enabled'</span><span class="s1">])</span><span class="s0">;</span>
                                <span class="s1">}</span>

                                <span class="s7">$v </span><span class="s1">= [</span>
                                    <span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s0">,</span>
                                    <span class="s8">'workflows' </span><span class="s1">=&gt; </span><span class="s7">$workflows</span><span class="s0">,</span>
                                <span class="s1">]</span><span class="s0">;</span>
                            <span class="s1">}</span>

                            <span class="s0">return </span><span class="s7">$v</span><span class="s0">;</span>
                        <span class="s1">})</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'workflows'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'support'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'place'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'transition'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'audit_trail'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">enumNode</span><span class="s1">(</span><span class="s8">'type'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">values</span><span class="s1">([</span><span class="s8">'workflow'</span><span class="s0">, </span><span class="s8">'state_machine'</span><span class="s1">])</span>
                                        <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'state_machine'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'marking_store'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">enumNode</span><span class="s1">(</span><span class="s8">'type'</span><span class="s1">)</span>
                                                <span class="s1">-&gt;</span><span class="s3">values</span><span class="s1">([</span><span class="s8">'method'</span><span class="s1">])</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'property'</span><span class="s1">)</span>
                                                <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'marking'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'service'</span><span class="s1">)</span>
                                                <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'supports'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">ifString</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; !</span><span class="s3">interface_exists</span><span class="s1">(</span><span class="s7">$v</span><span class="s0">, </span><span class="s3">false</span><span class="s1">)</span><span class="s0">; </span><span class="s1">})</span>
                                                <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'The supported class or interface &quot;%s&quot; does not exist.'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'support_strategy'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'initial_marking'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">castToArray</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'places'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$places</span><span class="s1">) {</span>
                                                <span class="s2">// It's an indexed array of shape  ['place1', 'place2']</span>
                                                <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$places</span><span class="s1">[</span><span class="s9">0</span><span class="s1">]) &amp;&amp; \</span><span class="s3">is_string</span><span class="s1">(</span><span class="s7">$places</span><span class="s1">[</span><span class="s9">0</span><span class="s1">])) {</span>
                                                    <span class="s0">return </span><span class="s3">array_map</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s3">string </span><span class="s7">$place</span><span class="s1">) {</span>
                                                        <span class="s0">return </span><span class="s1">[</span><span class="s8">'name' </span><span class="s1">=&gt; </span><span class="s7">$place</span><span class="s1">]</span><span class="s0">;</span>
                                                    <span class="s1">}</span><span class="s0">, </span><span class="s7">$places</span><span class="s1">)</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s2">// It's an indexed array, we let the validation occur</span>
                                                <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$places</span><span class="s1">[</span><span class="s9">0</span><span class="s1">]) &amp;&amp; \</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$places</span><span class="s1">[</span><span class="s9">0</span><span class="s1">])) {</span>
                                                    <span class="s0">return </span><span class="s7">$places</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$places </span><span class="s0">as </span><span class="s7">$name </span><span class="s1">=&gt; </span><span class="s7">$place</span><span class="s1">) {</span>
                                                    <span class="s0">if </span><span class="s1">(\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$place</span><span class="s1">) &amp;&amp; \</span><span class="s3">array_key_exists</span><span class="s1">(</span><span class="s8">'name'</span><span class="s0">, </span><span class="s7">$place</span><span class="s1">)) {</span>
                                                        <span class="s0">continue;</span>
                                                    <span class="s1">}</span>
                                                    <span class="s7">$place</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">] = </span><span class="s7">$name</span><span class="s0">;</span>
                                                    <span class="s7">$places</span><span class="s1">[</span><span class="s7">$name</span><span class="s1">] = </span><span class="s7">$place</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">return </span><span class="s3">array_values</span><span class="s1">(</span><span class="s7">$places</span><span class="s1">)</span><span class="s0">;</span>
                                            <span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">isRequired</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">isRequired</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'metadata'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                                    <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">([</span><span class="s8">'color' </span><span class="s1">=&gt; </span><span class="s8">'blue'</span><span class="s0">, </span><span class="s8">'description' </span><span class="s1">=&gt; </span><span class="s8">'Workflow to manage article.'</span><span class="s1">])</span>
                                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'variable'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'transitions'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$transitions</span><span class="s1">) {</span>
                                                <span class="s2">// It's an indexed array, we let the validation occur</span>
                                                <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$transitions</span><span class="s1">[</span><span class="s9">0</span><span class="s1">]) &amp;&amp; \</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$transitions</span><span class="s1">[</span><span class="s9">0</span><span class="s1">])) {</span>
                                                    <span class="s0">return </span><span class="s7">$transitions</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$transitions </span><span class="s0">as </span><span class="s7">$name </span><span class="s1">=&gt; </span><span class="s7">$transition</span><span class="s1">) {</span>
                                                    <span class="s0">if </span><span class="s1">(\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$transition</span><span class="s1">) &amp;&amp; \</span><span class="s3">array_key_exists</span><span class="s1">(</span><span class="s8">'name'</span><span class="s0">, </span><span class="s7">$transition</span><span class="s1">)) {</span>
                                                        <span class="s0">continue;</span>
                                                    <span class="s1">}</span>
                                                    <span class="s7">$transition</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">] = </span><span class="s7">$name</span><span class="s0">;</span>
                                                    <span class="s7">$transitions</span><span class="s1">[</span><span class="s7">$name</span><span class="s1">] = </span><span class="s7">$transition</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">return </span><span class="s7">$transitions</span><span class="s0">;</span>
                                            <span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">isRequired</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">isRequired</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'guard'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'An expression to block the transition'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">(</span><span class="s8">'is_fully_authenticated() and is_granted(</span><span class="s0">\'</span><span class="s8">ROLE_JOURNALIST</span><span class="s0">\'</span><span class="s8">) and subject.getTitle() == </span><span class="s0">\'</span><span class="s8">My first article</span><span class="s0">\'</span><span class="s8">'</span><span class="s1">)</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'from'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                                        <span class="s1">-&gt;</span><span class="s3">ifString</span><span class="s1">()</span>
                                                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)</span>
                                                        <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'to'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                                        <span class="s1">-&gt;</span><span class="s3">ifString</span><span class="s1">()</span>
                                                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)</span>
                                                        <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'metadata'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                                    <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">([</span><span class="s8">'color' </span><span class="s1">=&gt; </span><span class="s8">'blue'</span><span class="s0">, </span><span class="s8">'description' </span><span class="s1">=&gt; </span><span class="s8">'Workflow to manage article.'</span><span class="s1">])</span>
                                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'variable'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'metadata'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                        <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">([</span><span class="s8">'color' </span><span class="s1">=&gt; </span><span class="s8">'blue'</span><span class="s0">, </span><span class="s8">'description' </span><span class="s1">=&gt; </span><span class="s8">'Workflow to manage article.'</span><span class="s1">])</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'variable'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">return </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'supports'</span><span class="s1">] &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'support_strategy'</span><span class="s1">])</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'&quot;supports&quot; and &quot;support_strategy&quot; cannot be used together.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">return </span><span class="s1">!</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'supports'</span><span class="s1">] &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'support_strategy'</span><span class="s1">])</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'&quot;supports&quot; or &quot;support_strategy&quot; should be configured.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addRouterSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'router'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'router configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'resource'</span><span class="s1">)-&gt;</span><span class="s3">isRequired</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'type'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'http_port'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">80</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'https_port'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">443</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'strict_requirements'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span>
                                <span class="s8">&quot;set to true to throw an exception when a parameter does not match the requirements</span><span class="s0">\n</span><span class="s8">&quot;</span><span class="s1">.</span>
                                <span class="s8">&quot;set to false to disable exceptions when a parameter does not match the requirements (and return null instead)</span><span class="s0">\n</span><span class="s8">&quot;</span><span class="s1">.</span>
                                <span class="s8">&quot;set to null to disable parameter checks against requirements</span><span class="s0">\n</span><span class="s8">&quot;</span><span class="s1">.</span>
                                <span class="s8">&quot;'true' is the preferred configuration in development mode, while 'false' or 'null' might be preferred in production&quot;</span>
                            <span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'utf8'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addSessionSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'session'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'session configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'storage_id'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'session.storage.native'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'handler_id'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'session.handler.native_file'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                    <span class="s3">parse_str</span><span class="s1">(</span><span class="s7">$v</span><span class="s0">, </span><span class="s7">$parsed</span><span class="s1">)</span><span class="s0">;</span>

                                    <span class="s0">return </span><span class="s3">implode</span><span class="s1">(</span><span class="s8">'&amp;'</span><span class="s0">, </span><span class="s3">array_keys</span><span class="s1">(</span><span class="s7">$parsed</span><span class="s1">)) !== (string) </span><span class="s7">$v</span><span class="s0">;</span>
                                <span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'Session name %s contains illegal character(s)'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cookie_lifetime'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cookie_path'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cookie_domain'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">enumNode</span><span class="s1">(</span><span class="s8">'cookie_secure'</span><span class="s1">)-&gt;</span><span class="s3">values</span><span class="s1">([</span><span class="s3">true</span><span class="s0">, </span><span class="s3">false</span><span class="s0">, </span><span class="s8">'auto'</span><span class="s1">])-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'cookie_httponly'</span><span class="s1">)-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">enumNode</span><span class="s1">(</span><span class="s8">'cookie_samesite'</span><span class="s1">)-&gt;</span><span class="s3">values</span><span class="s1">([</span><span class="s3">null</span><span class="s0">, </span><span class="s3">Cookie</span><span class="s1">::</span><span class="s3">SAMESITE_LAX</span><span class="s0">, </span><span class="s3">Cookie</span><span class="s1">::</span><span class="s3">SAMESITE_STRICT</span><span class="s0">, </span><span class="s3">Cookie</span><span class="s1">::</span><span class="s3">SAMESITE_NONE</span><span class="s1">])-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'use_cookies'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'gc_divisor'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'gc_probability'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">1</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'gc_maxlifetime'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'save_path'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.cache_dir%/sessions'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'metadata_update_threshold'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">0</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'seconds to wait between 2 session metadata updates'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'sid_length'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">min</span><span class="s1">(</span><span class="s9">22</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">max</span><span class="s1">(</span><span class="s9">256</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'sid_bits_per_character'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">min</span><span class="s1">(</span><span class="s9">4</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">max</span><span class="s1">(</span><span class="s9">6</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addRequestSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'request'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'request configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">canBeEnabled</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'format'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'formats'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'mime_type'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'mime_type'</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">castToArray</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addAssetsSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'assets'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'assets configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Package</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'base_url'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'version_strategy'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'version'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'version_format'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%%s?%%s'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'json_manifest_path'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'base_path'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">''</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'base_urls'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">castToArray</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                            <span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version_strategy'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version'</span><span class="s1">])</span><span class="s0">;</span>
                        <span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You cannot use both &quot;version_strategy&quot; and &quot;version&quot; at the same time under &quot;assets&quot;.'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                            <span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version_strategy'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'json_manifest_path'</span><span class="s1">])</span><span class="s0">;</span>
                        <span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You cannot use both &quot;version_strategy&quot; and &quot;json_manifest_path&quot; at the same time under &quot;assets&quot;.'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                            <span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'json_manifest_path'</span><span class="s1">])</span><span class="s0">;</span>
                        <span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You cannot use both &quot;version&quot; and &quot;json_manifest_path&quot; at the same time under &quot;assets&quot;.'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'package'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'packages'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'base_url'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'version_strategy'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'version'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s8">'' </span><span class="s1">=== </span><span class="s7">$v</span><span class="s0">; </span><span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return; </span><span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'version_format'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'json_manifest_path'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'base_path'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">''</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'base_urls'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">castToArray</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version_strategy'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version'</span><span class="s1">])</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You cannot use both &quot;version_strategy&quot; and &quot;version&quot; at the same time under &quot;assets&quot; packages.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version_strategy'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'json_manifest_path'</span><span class="s1">])</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You cannot use both &quot;version_strategy&quot; and &quot;json_manifest_path&quot; at the same time under &quot;assets&quot; packages.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'version'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'json_manifest_path'</span><span class="s1">])</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You cannot use both &quot;version&quot; and &quot;json_manifest_path&quot; at the same time under &quot;assets&quot; packages.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addTranslatorSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'translator'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'translator configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Translator</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'fallback'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'path'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'fallbacks'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Defaults to the value of &quot;default_locale&quot;.'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">ifString</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'logging'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'formatter'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'translator.formatter.default'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cache_dir'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.cache_dir%/translations'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_path'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The default path used to load translations'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.project_dir%/translations'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'paths'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addValidationSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'validation'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'validation configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Validation</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cache'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'enable_annotations'</span><span class="s1">)-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Annotation</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'defaultTrue' </span><span class="s1">: </span><span class="s8">'defaultFalse'</span><span class="s1">}()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'static_method'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([</span><span class="s8">'loadValidatorMetadata'</span><span class="s1">])</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">treatFalseLike</span><span class="s1">([])</span>
                            <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()-&gt;</span><span class="s3">castToArray</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'translation_domain'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'validators'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">enumNode</span><span class="s1">(</span><span class="s8">'email_validation_mode'</span><span class="s1">)-&gt;</span><span class="s3">values</span><span class="s1">([</span><span class="s8">'html5'</span><span class="s0">, </span><span class="s8">'loose'</span><span class="s0">, </span><span class="s8">'strict'</span><span class="s1">])-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'mapping'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'path'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'paths'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'not_compromised_password'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">canBeDisabled</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'enabled'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'When disabled, compromised passwords will be accepted as valid.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'endpoint'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">defaultNull</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'API endpoint for the NotCompromisedPassword Validator.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'auto_mapping'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A collection of namespaces for which auto-mapping will be enabled by default, or null to opt-in with the EnableAutoMapping constraint.'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">([</span>
                                <span class="s8">'App</span><span class="s0">\\</span><span class="s8">Entity</span><span class="s0">\\</span><span class="s8">' </span><span class="s1">=&gt; []</span><span class="s0">,</span>
                                <span class="s8">'App</span><span class="s0">\\</span><span class="s8">WithSpecificLoaders</span><span class="s0">\\</span><span class="s8">' </span><span class="s1">=&gt; [</span><span class="s8">'validator.property_info_loader'</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">])</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'namespace'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">ifArray</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s0">array </span><span class="s7">$values</span><span class="s1">): </span><span class="s0">array </span><span class="s1">{</span>
                                    <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$values </span><span class="s0">as </span><span class="s7">$k </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'service'</span><span class="s1">])) {</span>
                                            <span class="s0">continue;</span>
                                        <span class="s1">}</span>

                                        <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'namespace'</span><span class="s1">])) {</span>
                                            <span class="s7">$values</span><span class="s1">[</span><span class="s7">$k</span><span class="s1">][</span><span class="s8">'services'</span><span class="s1">] = []</span><span class="s0">;</span>
                                            <span class="s0">continue;</span>
                                        <span class="s1">}</span>

                                        <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">)) {</span>
                                            <span class="s7">$values</span><span class="s1">[</span><span class="s7">$v</span><span class="s1">][</span><span class="s8">'services'</span><span class="s1">] = []</span><span class="s0">;</span>
                                            <span class="s0">unset</span><span class="s1">(</span><span class="s7">$values</span><span class="s1">[</span><span class="s7">$k</span><span class="s1">])</span><span class="s0">;</span>
                                            <span class="s0">continue;</span>
                                        <span class="s1">}</span>

                                        <span class="s7">$tmp </span><span class="s1">= </span><span class="s7">$v</span><span class="s0">;</span>
                                        <span class="s0">unset</span><span class="s1">(</span><span class="s7">$values</span><span class="s1">[</span><span class="s7">$k</span><span class="s1">])</span><span class="s0">;</span>
                                        <span class="s7">$values</span><span class="s1">[</span><span class="s7">$k</span><span class="s1">][</span><span class="s8">'services'</span><span class="s1">] = </span><span class="s7">$tmp</span><span class="s0">;</span>
                                    <span class="s1">}</span>

                                    <span class="s0">return </span><span class="s7">$values</span><span class="s0">;</span>
                                <span class="s1">})</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">arrayPrototype</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'service'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'services'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addAnnotationsSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'annotations'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'annotation configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Annotation</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cache'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s3">interface_exists</span><span class="s1">(</span><span class="s3">Cache</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'php_array' </span><span class="s1">: </span><span class="s8">'none'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'file_cache_dir'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.cache_dir%/annotations'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'debug'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addSerializerSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'serializer'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'serializer configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Serializer</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'enable_annotations'</span><span class="s1">)-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Annotation</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'defaultTrue' </span><span class="s1">: </span><span class="s8">'defaultFalse'</span><span class="s1">}()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'name_converter'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'circular_reference_handler'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'max_depth_handler'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'mapping'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'path'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'paths'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addPropertyAccessSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'property_access'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Property access configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'magic_call'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'throw_exception_on_invalid_index'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'throw_exception_on_invalid_property_path'</span><span class="s1">)-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addPropertyInfoSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'property_info'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Property info configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">interface_exists</span><span class="s1">(</span><span class="s3">PropertyInfoExtractorInterface</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addCacheSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'cache'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Cache configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'pool'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'prefix_seed'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Used to namespace cache keys when using several apps with the same shared backend'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">(</span><span class="s8">'my-application-name'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'app'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'App related cache pools configuration'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'cache.adapter.filesystem'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'system'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'System related cache pools configuration'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'cache.adapter.system'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'directory'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'%kernel.cache_dir%/pools'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_doctrine_provider'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_psr6_provider'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_redis_provider'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'redis://localhost'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_memcached_provider'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'memcached://localhost'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_pdo_provider'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Connection</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'database_connection' </span><span class="s1">: </span><span class="s3">null</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'pools'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'adapter'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'adapters'</span><span class="s1">]) || \</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'adapter'</span><span class="s1">] ?? </span><span class="s3">null</span><span class="s1">)) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'provider'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'Pool cannot have a &quot;provider&quot; while &quot;adapter&quot; is set to a map'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'adapters'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">performNoDeepMerging</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'One or more adapters to chain for creating the pool, defaults to &quot;cache.app&quot;.'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$values</span><span class="s1">) {</span>
                                                <span class="s0">if </span><span class="s1">([</span><span class="s9">0</span><span class="s1">] === </span><span class="s3">array_keys</span><span class="s1">(</span><span class="s7">$values</span><span class="s1">) &amp;&amp; \</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$values</span><span class="s1">[</span><span class="s9">0</span><span class="s1">])) {</span>
                                                    <span class="s0">return </span><span class="s7">$values</span><span class="s1">[</span><span class="s9">0</span><span class="s1">]</span><span class="s0">;</span>
                                                <span class="s1">}</span>
                                                <span class="s7">$adapters </span><span class="s1">= []</span><span class="s0">;</span>

                                                <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$values </span><span class="s0">as </span><span class="s7">$k </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">) {</span>
                                                    <span class="s0">if </span><span class="s1">(\</span><span class="s3">is_int</span><span class="s1">(</span><span class="s7">$k</span><span class="s1">) &amp;&amp; \</span><span class="s3">is_string</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">)) {</span>
                                                        <span class="s7">$adapters</span><span class="s1">[] = </span><span class="s7">$v</span><span class="s0">;</span>
                                                    <span class="s1">} </span><span class="s0">elseif </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">)) {</span>
                                                        <span class="s7">$adapters</span><span class="s1">[</span><span class="s7">$k</span><span class="s1">] = </span><span class="s7">$v</span><span class="s0">;</span>
                                                    <span class="s1">} </span><span class="s0">elseif </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'provider'</span><span class="s1">])) {</span>
                                                        <span class="s7">$adapters</span><span class="s1">[</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'provider'</span><span class="s1">]] = </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">] ?? </span><span class="s7">$v</span><span class="s0">;</span>
                                                    <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                                                        <span class="s7">$adapters</span><span class="s1">[] = </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">] ?? </span><span class="s7">$v</span><span class="s0">;</span>
                                                    <span class="s1">}</span>
                                                <span class="s1">}</span>

                                                <span class="s0">return </span><span class="s7">$adapters</span><span class="s0">;</span>
                                            <span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'tags'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'public'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'default_lifetime'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'provider'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Overwrite the setting from the default provider for this adapter.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'clearer'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'cache.app'</span><span class="s1">]) || </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'cache.system'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'&quot;cache.app&quot; and &quot;cache.system&quot; are reserved names'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addPhpErrorsSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'php_errors'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'PHP errors handling configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'log'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Use the application logger instead of the PHP logger for logging PHP errors.'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">example</span><span class="s1">(</span><span class="s8">'&quot;true&quot; to use the default configuration: log all errors. &quot;false&quot; to disable. An integer bit field of E_* constants.'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">treatNullLike</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">!(\</span><span class="s3">is_int</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) || \</span><span class="s3">is_bool</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">))</span><span class="s0">; </span><span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'The &quot;php_errors.log&quot; parameter should be either an integer or a boolean.'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'throw'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Throw PHP errors as \ErrorException instances.'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">treatNullLike</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addLockSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'lock'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Lock configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Lock</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifString</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s0">, </span><span class="s8">'resources' </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s7">$v </span><span class="s1">+ [</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'resources'</span><span class="s1">]) &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'resource'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                            <span class="s7">$e </span><span class="s1">= </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">]</span><span class="s0">;</span>
                            <span class="s0">unset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'enabled'</span><span class="s1">])</span><span class="s0">;</span>

                            <span class="s0">return </span><span class="s1">[</span><span class="s8">'enabled' </span><span class="s1">=&gt; </span><span class="s7">$e</span><span class="s0">, </span><span class="s8">'resources' </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">]</span><span class="s0">;</span>
                        <span class="s1">})</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'resource'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'resources'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([</span><span class="s8">'default' </span><span class="s1">=&gt; [</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">SemaphoreStore</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">SemaphoreStore</span><span class="s1">::</span><span class="s3">isSupported</span><span class="s1">() ? </span><span class="s8">'semaphore' </span><span class="s1">: </span><span class="s8">'flock'</span><span class="s1">]])</span>
                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">ifString</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s8">'default' </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; </span><span class="s3">array_keys</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) === </span><span class="s3">range</span><span class="s1">(</span><span class="s9">0</span><span class="s0">, </span><span class="s1">\</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) - </span><span class="s9">1</span><span class="s1">)</span><span class="s0">; </span><span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                    <span class="s7">$resources </span><span class="s1">= []</span><span class="s0">;</span>
                                    <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$v </span><span class="s0">as </span><span class="s7">$resource</span><span class="s1">) {</span>
                                        <span class="s7">$resources </span><span class="s1">= </span><span class="s3">array_merge_recursive</span><span class="s1">(</span>
                                            <span class="s7">$resources</span><span class="s0">,</span>
                                            <span class="s1">\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$resource</span><span class="s1">) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$resource</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">])</span>
                                                <span class="s1">? [</span><span class="s7">$resource</span><span class="s1">[</span><span class="s8">'name'</span><span class="s1">] =&gt; </span><span class="s7">$resource</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]]</span>
                                                <span class="s1">: [</span><span class="s8">'default' </span><span class="s1">=&gt; </span><span class="s7">$resource</span><span class="s1">]</span>
                                        <span class="s1">)</span><span class="s0">;</span>
                                    <span class="s1">}</span>

                                    <span class="s0">return </span><span class="s7">$resources</span><span class="s0">;</span>
                                <span class="s1">})</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">ifString</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addWebLinkSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'web_link'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'web links configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">HttpHeaderSerializer</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addMessengerSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'messenger'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Messenger configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">interface_exists</span><span class="s1">(</span><span class="s3">MessageBusInterface</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'transport'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'bus'</span><span class="s0">, </span><span class="s8">'buses'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'buses'</span><span class="s1">]) &amp;&amp; \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'buses'</span><span class="s1">]) &gt; </span><span class="s9">1 </span><span class="s1">&amp;&amp; </span><span class="s3">null </span><span class="s1">=== </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'default_bus'</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'You must specify the &quot;default_bus&quot; if you define more than one bus.'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">static function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">): </span><span class="s3">bool </span><span class="s1">{ </span><span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'buses'</span><span class="s1">]) &amp;&amp; </span><span class="s3">null </span><span class="s1">!== </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'default_bus'</span><span class="s1">] &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'buses'</span><span class="s1">][</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'default_bus'</span><span class="s1">]])</span><span class="s0">; </span><span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">static function </span><span class="s1">(</span><span class="s0">array </span><span class="s7">$v</span><span class="s1">): </span><span class="s3">void </span><span class="s1">{ </span><span class="s0">throw new </span><span class="s3">InvalidConfigurationException</span><span class="s1">(</span><span class="s3">sprintf</span><span class="s1">(</span><span class="s8">'The specified default bus &quot;%s&quot; is not configured. Available buses are &quot;%s&quot;.'</span><span class="s0">, </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'default_bus'</span><span class="s1">]</span><span class="s0">, </span><span class="s3">implode</span><span class="s1">(</span><span class="s8">'&quot;, &quot;'</span><span class="s0">, </span><span class="s3">array_keys</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'buses'</span><span class="s1">]))))</span><span class="s0">; </span><span class="s1">})</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'routing'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'message_class'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) {</span>
                                    <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">)) {</span>
                                        <span class="s0">return </span><span class="s1">[]</span><span class="s0">;</span>
                                    <span class="s1">}</span>
                                    <span class="s2">// If XML config with only one routing attribute</span>
                                    <span class="s0">if </span><span class="s1">(</span><span class="s9">2 </span><span class="s1">=== \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'message-class'</span><span class="s1">]) &amp;&amp; </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'sender'</span><span class="s1">])) {</span>
                                        <span class="s7">$config </span><span class="s1">= [</span><span class="s9">0 </span><span class="s1">=&gt; </span><span class="s7">$config</span><span class="s1">]</span><span class="s0">;</span>
                                    <span class="s1">}</span>

                                    <span class="s7">$newConfig </span><span class="s1">= []</span><span class="s0">;</span>
                                    <span class="s0">foreach </span><span class="s1">(</span><span class="s7">$config </span><span class="s0">as </span><span class="s7">$k </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">) {</span>
                                        <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_int</span><span class="s1">(</span><span class="s7">$k</span><span class="s1">)) {</span>
                                            <span class="s7">$newConfig</span><span class="s1">[</span><span class="s7">$k</span><span class="s1">] = [</span>
                                                <span class="s8">'senders' </span><span class="s1">=&gt; </span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'senders'</span><span class="s1">] ?? (\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) ? </span><span class="s3">array_values</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) : [</span><span class="s7">$v</span><span class="s1">])</span><span class="s0">,</span>
                                            <span class="s1">]</span><span class="s0">;</span>
                                        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                                            <span class="s7">$newConfig</span><span class="s1">[</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'message-class'</span><span class="s1">]][</span><span class="s8">'senders'</span><span class="s1">] = </span><span class="s3">array_map</span><span class="s1">(</span>
                                                <span class="s0">function </span><span class="s1">(</span><span class="s7">$a</span><span class="s1">) {</span>
                                                    <span class="s0">return </span><span class="s1">\</span><span class="s3">is_string</span><span class="s1">(</span><span class="s7">$a</span><span class="s1">) ? </span><span class="s7">$a </span><span class="s1">: </span><span class="s7">$a</span><span class="s1">[</span><span class="s8">'service'</span><span class="s1">]</span><span class="s0">;</span>
                                                <span class="s1">}</span><span class="s0">,</span>
                                                <span class="s3">array_values</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'sender'</span><span class="s1">])</span>
                                            <span class="s1">)</span><span class="s0">;</span>
                                        <span class="s1">}</span>
                                    <span class="s1">}</span>

                                    <span class="s0">return </span><span class="s7">$newConfig</span><span class="s0">;</span>
                                <span class="s1">})</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">performNoDeepMerging</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'senders'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">requiresAtLeastOneElement</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'serializer'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_serializer'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'messenger.transport.native_php_serializer'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Service id to use as the default serializer for the transports.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'symfony_serializer'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'format'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">'json'</span><span class="s1">)-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Serialization format for the messenger.transport.symfony_serializer service (which is not the serializer used by default).'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'context'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Context array for the messenger.transport.symfony_serializer service (which is not the serializer used by default).'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'variable'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'transports'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">arrayPrototype</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifString</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s3">string </span><span class="s7">$dsn</span><span class="s1">) {</span>
                                        <span class="s0">return </span><span class="s1">[</span><span class="s8">'dsn' </span><span class="s1">=&gt; </span><span class="s7">$dsn</span><span class="s1">]</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'option'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'dsn'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'serializer'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Service id of a custom serializer to use.'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'options'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                        <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'variable'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'retry_strategy'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                                <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'service'</span><span class="s1">]) &amp;&amp; (</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'max_retries'</span><span class="s1">]) || </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'delay'</span><span class="s1">]) || </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'multiplier'</span><span class="s1">]) || </span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'max_delay'</span><span class="s1">]))) {</span>
                                                    <span class="s0">throw new </span><span class="s1">\</span><span class="s3">InvalidArgumentException</span><span class="s1">(</span><span class="s8">'The &quot;service&quot; cannot be used along with the other &quot;retry_strategy&quot; options.'</span><span class="s1">)</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">return </span><span class="s7">$v</span><span class="s0">;</span>
                                            <span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'service'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Service id to override the retry strategy entirely'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'max_retries'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">3</span><span class="s1">)-&gt;</span><span class="s3">min</span><span class="s1">(</span><span class="s9">0</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'delay'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">1000</span><span class="s1">)-&gt;</span><span class="s3">min</span><span class="s1">(</span><span class="s9">0</span><span class="s1">)-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Time in ms to delay (or the initial value when multiplier is used)'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">floatNode</span><span class="s1">(</span><span class="s8">'multiplier'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">2</span><span class="s1">)-&gt;</span><span class="s3">min</span><span class="s1">(</span><span class="s9">1</span><span class="s1">)-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'If greater than 1, delay will grow exponentially for each retry: this delay = (delay * (multiple ^ retries))'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'max_delay'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s9">0</span><span class="s1">)-&gt;</span><span class="s3">min</span><span class="s1">(</span><span class="s9">0</span><span class="s1">)-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Max time in ms that a retry should ever be delayed (0 = infinite)'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'failure_transport'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultNull</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Transport name to send failed messages to (after all retries have failed).'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'default_bus'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'buses'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([</span><span class="s8">'messenger.bus.default' </span><span class="s1">=&gt; [</span><span class="s8">'default_middleware' </span><span class="s1">=&gt; </span><span class="s3">true</span><span class="s0">, </span><span class="s8">'middleware' </span><span class="s1">=&gt; []]])</span>
                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">arrayPrototype</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">addDefaultsIfNotSet</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">enumNode</span><span class="s1">(</span><span class="s8">'default_middleware'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">values</span><span class="s1">([</span><span class="s3">true</span><span class="s0">, </span><span class="s3">false</span><span class="s0">, </span><span class="s8">'allow_no_handlers'</span><span class="s1">])</span>
                                        <span class="s1">-&gt;</span><span class="s3">defaultTrue</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'middleware'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">performNoDeepMerging</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">\</span><span class="s3">is_string</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) || (\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) &amp;&amp; !\</span><span class="s3">is_int</span><span class="s1">(</span><span class="s3">key</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">)))</span><span class="s0">; </span><span class="s1">})</span>
                                            <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                        <span class="s1">-&gt;</span><span class="s3">arrayPrototype</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">): </span><span class="s0">array </span><span class="s1">{</span>
                                                    <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">)) {</span>
                                                        <span class="s0">return </span><span class="s1">[</span><span class="s8">'id' </span><span class="s1">=&gt; </span><span class="s7">$middleware</span><span class="s1">]</span><span class="s0">;</span>
                                                    <span class="s1">}</span>
                                                    <span class="s0">if </span><span class="s1">(</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">[</span><span class="s8">'id'</span><span class="s1">])) {</span>
                                                        <span class="s0">return </span><span class="s7">$middleware</span><span class="s0">;</span>
                                                    <span class="s1">}</span>
                                                    <span class="s0">if </span><span class="s1">(</span><span class="s9">1 </span><span class="s1">&lt; \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">)) {</span>
                                                        <span class="s0">throw new </span><span class="s1">\</span><span class="s3">InvalidArgumentException</span><span class="s1">(</span><span class="s3">sprintf</span><span class="s1">(</span><span class="s8">'Invalid middleware at path &quot;framework.messenger&quot;: a map with a single factory id as key and its arguments as value was expected, %s given.'</span><span class="s0">, </span><span class="s3">json_encode</span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">)))</span><span class="s0">;</span>
                                                    <span class="s1">}</span>

                                                    <span class="s0">return </span><span class="s1">[</span>
                                                        <span class="s8">'id' </span><span class="s1">=&gt; </span><span class="s3">key</span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">)</span><span class="s0">,</span>
                                                        <span class="s8">'arguments' </span><span class="s1">=&gt; </span><span class="s3">current</span><span class="s1">(</span><span class="s7">$middleware</span><span class="s1">)</span><span class="s0">,</span>
                                                    <span class="s1">]</span><span class="s0">;</span>
                                                <span class="s1">})</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'argument'</span><span class="s1">)</span>
                                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'id'</span><span class="s1">)-&gt;</span><span class="s3">isRequired</span><span class="s1">()-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'arguments'</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                                    <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">([])</span>
                                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'variable'</span><span class="s1">)</span>
                                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addRobotsIndexSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'disallow_search_engine_index'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Enabled by default when debug is enabled.'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">treatNullLike</span><span class="s1">(</span><span class="s7">$this</span><span class="s1">-&gt;</span><span class="s3">debug</span><span class="s1">)</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addHttpClientSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'http_client'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'HTTP Client configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">HttpClient</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'scoped_client'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'max_host_connections'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The maximum number of connections to a single host.'</span><span class="s1">)</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'default_options'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'header'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'headers'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array: header =&gt; value(s).'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">variablePrototype</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'max_redirects'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The maximum number of redirects to follow.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'http_version'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The default HTTP version, typically 1.1 or 2.0, leave to null for the best version.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'resolve'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array: domain =&gt; IP.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'host'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) {</span>
                                            <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">)) {</span>
                                                <span class="s0">return </span><span class="s1">[]</span><span class="s0">;</span>
                                            <span class="s1">}</span>
                                            <span class="s0">if </span><span class="s1">(!</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'host'</span><span class="s1">]</span><span class="s0">, </span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]) || \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) &gt; </span><span class="s9">2</span><span class="s1">) {</span>
                                                <span class="s0">return </span><span class="s7">$config</span><span class="s0">;</span>
                                            <span class="s1">}</span>

                                            <span class="s0">return </span><span class="s1">[</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'host'</span><span class="s1">] =&gt; </span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]]</span><span class="s0">;</span>
                                        <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarPrototype</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'proxy'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The URL of the proxy to pass requests through or null for automatic detection.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'no_proxy'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A comma separated list of hosts that do not require a proxy to be reached.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">floatNode</span><span class="s1">(</span><span class="s8">'timeout'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The idle timeout, defaults to the &quot;default_socket_timeout&quot; ini parameter.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">floatNode</span><span class="s1">(</span><span class="s8">'max_duration'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The maximum execution time for the request+response as a whole.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'bindto'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A network interface name, IP address, a host name or a UNIX socket to bind to.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'verify_peer'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Indicates if the peer should be verified in a SSL/TLS context.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'verify_host'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Indicates if the host should exist as a certificate common name.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cafile'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A certificate authority file.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'capath'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A directory that contains multiple certificate authority files.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'local_cert'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A PEM formatted certificate file.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'local_pk'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A private key file.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'passphrase'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The passphrase used to encrypt the &quot;local_pk&quot; file.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'ciphers'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A list of SSL/TLS ciphers separated by colons, commas or spaces (e.g. &quot;RC3-SHA:TLS13-AES-128-GCM-SHA256&quot;...)'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'peer_fingerprint'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array: hashing algorithm =&gt; hash(es).'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">variableNode</span><span class="s1">(</span><span class="s8">'sha1'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">variableNode</span><span class="s1">(</span><span class="s8">'pin-sha256'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">variableNode</span><span class="s1">(</span><span class="s8">'md5'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'scoped_clients'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">arrayPrototype</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'header'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) {</span>
                                        <span class="s0">if </span><span class="s1">(!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">HttpClient</span><span class="s1">::</span><span class="s0">class</span><span class="s1">)) {</span>
                                            <span class="s0">throw new </span><span class="s3">LogicException</span><span class="s1">(</span><span class="s8">'HttpClient support cannot be enabled as the component is not installed. Try running &quot;composer require symfony/http-client&quot;.'</span><span class="s1">)</span><span class="s0">;</span>
                                        <span class="s1">}</span>

                                        <span class="s0">return </span><span class="s1">\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) ? </span><span class="s7">$config </span><span class="s1">: [</span><span class="s8">'base_uri' </span><span class="s1">=&gt; </span><span class="s7">$config</span><span class="s1">]</span><span class="s0">;</span>
                                    <span class="s1">})</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">!</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'scope'</span><span class="s1">]) &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'base_uri'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'Either &quot;scope&quot; or &quot;base_uri&quot; should be defined.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">!</span><span class="s0">empty</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'query'</span><span class="s1">]) &amp;&amp; !</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'base_uri'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'&quot;query&quot; applies to &quot;base_uri&quot; but no base URI is defined.'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'scope'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The regular expression that the request URL must match before adding the other options. When none is provided, the base URI is used instead.'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'base_uri'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The URI to resolve relative URLs, following rules in RFC 3985, section 2.'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'auth_basic'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'An HTTP Basic authentication &quot;username:password&quot;.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'auth_bearer'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A token enabling HTTP Bearer authorization.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'auth_ntlm'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A &quot;username:password&quot; pair to use Microsoft NTLM authentication (requires the cURL extension).'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'query'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array of query string values merged with the base URI.'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'key'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) {</span>
                                                <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">)) {</span>
                                                    <span class="s0">return </span><span class="s1">[]</span><span class="s0">;</span>
                                                <span class="s1">}</span>
                                                <span class="s0">if </span><span class="s1">(!</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'key'</span><span class="s1">]</span><span class="s0">, </span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]) || \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) &gt; </span><span class="s9">2</span><span class="s1">) {</span>
                                                    <span class="s0">return </span><span class="s7">$config</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">return </span><span class="s1">[</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'key'</span><span class="s1">] =&gt; </span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]]</span><span class="s0">;</span>
                                            <span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">scalarPrototype</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'headers'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array: header =&gt; value(s).'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">variablePrototype</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">integerNode</span><span class="s1">(</span><span class="s8">'max_redirects'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The maximum number of redirects to follow.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'http_version'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The default HTTP version, typically 1.1 or 2.0, leave to null for the best version.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'resolve'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array: domain =&gt; IP.'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'host'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">always</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) {</span>
                                                <span class="s0">if </span><span class="s1">(!\</span><span class="s3">is_array</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">)) {</span>
                                                    <span class="s0">return </span><span class="s1">[]</span><span class="s0">;</span>
                                                <span class="s1">}</span>
                                                <span class="s0">if </span><span class="s1">(!</span><span class="s0">isset</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'host'</span><span class="s1">]</span><span class="s0">, </span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]) || \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$config</span><span class="s1">) &gt; </span><span class="s9">2</span><span class="s1">) {</span>
                                                    <span class="s0">return </span><span class="s7">$config</span><span class="s0">;</span>
                                                <span class="s1">}</span>

                                                <span class="s0">return </span><span class="s1">[</span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'host'</span><span class="s1">] =&gt; </span><span class="s7">$config</span><span class="s1">[</span><span class="s8">'value'</span><span class="s1">]]</span><span class="s0">;</span>
                                            <span class="s1">})</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">scalarPrototype</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'proxy'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The URL of the proxy to pass requests through or null for automatic detection.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'no_proxy'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A comma separated list of hosts that do not require a proxy to be reached.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">floatNode</span><span class="s1">(</span><span class="s8">'timeout'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The idle timeout, defaults to the &quot;default_socket_timeout&quot; ini parameter.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">floatNode</span><span class="s1">(</span><span class="s8">'max_duration'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The maximum execution time for the request+response as a whole.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'bindto'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A network interface name, IP address, a host name or a UNIX socket to bind to.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'verify_peer'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Indicates if the peer should be verified in a SSL/TLS context.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'verify_host'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Indicates if the host should exist as a certificate common name.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'cafile'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A certificate authority file.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'capath'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A directory that contains multiple certificate authority files.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'local_cert'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A PEM formatted certificate file.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'local_pk'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A private key file.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'passphrase'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'The passphrase used to encrypt the &quot;local_pk&quot; file.'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'ciphers'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'A list of SSL/TLS ciphers separated by colons, commas or spaces (e.g. &quot;RC3-SHA:TLS13-AES-128-GCM-SHA256&quot;...)'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'peer_fingerprint'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Associative array: hashing algorithm =&gt; hash(es).'</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">normalizeKeys</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)</span>
                                        <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">variableNode</span><span class="s1">(</span><span class="s8">'sha1'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">variableNode</span><span class="s1">(</span><span class="s8">'pin-sha256'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                            <span class="s1">-&gt;</span><span class="s3">variableNode</span><span class="s1">(</span><span class="s8">'md5'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addMailerSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'mailer'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Mailer configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Mailer</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">validate</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">ifTrue</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return isset</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'dsn'</span><span class="s1">]) &amp;&amp; \</span><span class="s3">count</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">[</span><span class="s8">'transports'</span><span class="s1">])</span><span class="s0">; </span><span class="s1">})</span>
                        <span class="s1">-&gt;</span><span class="s3">thenInvalid</span><span class="s1">(</span><span class="s8">'&quot;dsn&quot; and &quot;transports&quot; cannot be used together.'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'transport'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'dsn'</span><span class="s1">)-&gt;</span><span class="s3">defaultNull</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'transports'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'envelope'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Mailer Envelope configuration'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'sender'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'recipients'</span><span class="s1">)</span>
                                    <span class="s1">-&gt;</span><span class="s3">performNoDeepMerging</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">ifArray</span><span class="s1">()</span>
                                        <span class="s1">-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s7">$v</span><span class="s1">) {</span>
                                            <span class="s0">return </span><span class="s3">array_filter</span><span class="s1">(</span><span class="s3">array_values</span><span class="s1">(</span><span class="s7">$v</span><span class="s1">))</span><span class="s0">;</span>
                                        <span class="s1">})</span>
                                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">private function </span><span class="s3">addNotifierSection</span><span class="s1">(</span><span class="s3">ArrayNodeDefinition </span><span class="s7">$rootNode</span><span class="s1">)</span>
    <span class="s1">{</span>
        <span class="s7">$rootNode</span>
            <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'notifier'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">info</span><span class="s1">(</span><span class="s8">'Notifier configuration'</span><span class="s1">)</span>
                    <span class="s1">-&gt;{!</span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">FullStack</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) &amp;&amp; </span><span class="s3">class_exists</span><span class="s1">(</span><span class="s3">Notifier</span><span class="s1">::</span><span class="s0">class</span><span class="s1">) ? </span><span class="s8">'canBeDisabled' </span><span class="s1">: </span><span class="s8">'canBeEnabled'</span><span class="s1">}()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'chatter_transport'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'chatter_transports'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'texter_transport'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'texter_transports'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">booleanNode</span><span class="s1">(</span><span class="s8">'notification_on_failed_messages'</span><span class="s1">)-&gt;</span><span class="s3">defaultFalse</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'channel_policy'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">useAttributeAsKey</span><span class="s1">(</span><span class="s8">'name'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">beforeNormalization</span><span class="s1">()-&gt;</span><span class="s3">ifString</span><span class="s1">()-&gt;</span><span class="s3">then</span><span class="s1">(</span><span class="s0">function </span><span class="s1">(</span><span class="s3">string </span><span class="s7">$v</span><span class="s1">) { </span><span class="s0">return </span><span class="s1">[</span><span class="s7">$v</span><span class="s1">]</span><span class="s0">; </span><span class="s1">})-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'scalar'</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">fixXmlConfig</span><span class="s1">(</span><span class="s8">'admin_recipient'</span><span class="s1">)</span>
                    <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">arrayNode</span><span class="s1">(</span><span class="s8">'admin_recipients'</span><span class="s1">)</span>
                            <span class="s1">-&gt;</span><span class="s3">prototype</span><span class="s1">(</span><span class="s8">'array'</span><span class="s1">)</span>
                                <span class="s1">-&gt;</span><span class="s3">children</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'email'</span><span class="s1">)-&gt;</span><span class="s3">cannotBeEmpty</span><span class="s1">()-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                    <span class="s1">-&gt;</span><span class="s3">scalarNode</span><span class="s1">(</span><span class="s8">'phone'</span><span class="s1">)-&gt;</span><span class="s3">defaultValue</span><span class="s1">(</span><span class="s8">''</span><span class="s1">)-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                        <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                    <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
                <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
            <span class="s1">-&gt;</span><span class="s3">end</span><span class="s1">()</span>
        <span class="s0">;</span>
    <span class="s1">}</span>
<span class="s1">}</span>
</pre>
</body>
</html>